# Software Tools

2 python tools are currently available. Mainly the flashloader is of interest tough

## flashLoader.py

### Purpose
* Reads the provided .bin file and converts it into several Intel HEX records
* Checks on which USB port a TeachZ80 (in Flash Mode) is connected
* When the board is found, sends the HEX records to the Board which then
  * Erases the flash
  * Burns the received data to the flash
  * After the last record, resets the Z80 and gives back control over the bus, which starts the new software
 
 ### Requirements
 * python3 installed on the system. [Python](https://www.python.org/)
 * pySerial installed on the system. ``` pip3 install pySerial ``` [pySerial](https://pypi.org/project/pyserial/)

### Usage
```
python3 flashLoader.py <binfile.bin>
```
```
koebi@rpi4b:~/TeachZ80/Software/Z80/test$ python3 ../../tools/flashLoader.py serial-polled.bin

FlashLoader Script Version 1.0

TeachZ80 fount on /dev/ttyUSB0
488 data bytes available in 'serial-polled.bin'
32 HEX records created

Download record    1 of   32 -   3% - [=                   ] - :100000003E05D3103E00D32021000011000001E87E - CONFIRMED
Download record    2 of   32 -   6% - [=                   ] - :1000100001EDB0DB70310000CD2701CD2201215C64 - CONFIRMED
Download record    3 of   32 -   9% - [==                  ] - :1000200000CDCE0121000001E8011E01CD5B0121C0 - CONFIRMED
Download record    4 of   32 -  12% - [==                  ] - :10003000B800CDCE01CD450021E500CDCE01CD5299 - CONFIRMED
Download record    5 of   32 -  16% - [===                 ] - :100040000076C341000E20CD41010C3E7FB9C2476E - CONFIRMED
Download record    6 of   32 -  19% - [====                ] - :1000500000C9CD53014FCD4101C352000D0A0D0A15 - CONFIRMED
Download record    7 of   32 -  22% - [====                ] - :1000600048656C6C6F20576F726C64202D2054654E - CONFIRMED
Download record    8 of   32 -  25% - [=====               ] - :100070006163685A383020737065616B696E672000 - CONFIRMED
Download record    9 of   32 -  28% - [======              ] - :100080002D2057656C6C20646F6E65210D0A0D0A7A - CONFIRMED
Download record   10 of   32 -  31% - [======              ] - :10009000546869732069732074686520636F6465B0 - CONFIRMED
Download record   11 of   32 -  34% - [=======             ] - :1000A00020492063757272656E746C79206578657D - CONFIRMED
Download record   12 of   32 -  38% - [========            ] - :1000B000637574653A0D0A000D0A416E6420686527 - CONFIRMED
Download record   13 of   32 -  41% - [========            ] - :1000C000726520746865207072696E7461626C6517 - CONFIRMED
Download record   14 of   32 -  44% - [=========           ] - :1000D00020415343494920636861726163746572CA - CONFIRMED
Download record   15 of   32 -  47% - [=========           ] - :1000E000733A0D0A000D0A0D0A492077696C6C20DD - CONFIRMED
Download record   16 of   32 -  50% - [==========          ] - :1000F0006E6F77206563686F2077686174657665D9 - CONFIRMED
Download record   17 of   32 -  53% - [===========         ] - :100100007220796F7520747970653A0D0A00DB32C0 - CONFIRMED
Download record   18 of   32 -  56% - [===========         ] - :10011000E604C9DB33E604C9DB32E601C9DB33E6BA - CONFIRMED
Download record   19 of   32 -  59% - [============        ] - :1001200001C90E33C329010E322131010607EDB397 - CONFIRMED
Download record   20 of   32 -  62% - [============        ] - :10013000C918044403C10568CD130128FB79D331E4 - CONFIRMED
Download record   21 of   32 -  66% - [=============       ] - :10014000C9CD0E0128FB79D330C9CD1D0128FB3A5A - CONFIRMED
Download record   22 of   32 -  69% - [==============      ] - :100150003100C9CD180128FBDB30C9F5D5E5C5C391 - CONFIRMED
Download record   23 of   32 -  72% - [==============      ] - :100160007F017BB7280E7DE60F2811FE0820050EC3 - CONFIRMED
Download record   24 of   32 -  75% - [===============     ] - :1001700020CD41010E20CD4101C39101CDE1017C93 - CONFIRMED
Download record   25 of   32 -  78% - [================    ] - :10018000CDA5017DCDA5010E3ACD41010E20CD4179 - CONFIRMED
Download record   26 of   32 -  81% - [================    ] - :10019000017ECDA50123C10BC578B120C5CDE101FC - CONFIRMED
Download record   27 of   32 -  84% - [=================   ] - :1001A000C1E1D1F1C9F5CB3FCB3FCB3FCB3FCDBA7E - CONFIRMED
Download record   28 of   32 -  88% - [==================  ] - :1001B00001F1F5E60FCDBA01F1C9C630FE3AFAC336 - CONFIRMED
Download record   29 of   32 -  91% - [==================  ] - :1001C00001C6074FC34101E3CDD40123E3C9E5CD07 - CONFIRMED
Download record   30 of   32 -  94% - [=================== ] - :1001D000D401E1C97EB728084FCD410123C3D40122 - CONFIRMED
Download record   31 of   32 -  97% - [=================== ] - :0801E000C9CDC7010D0A00C9D9 - CONFIRMED
Download record   32 of   32 - 100% - [====================] - :00000001FF - CONFIRMED

DOWNLOAD COMPLETED SUCCESSFULLY
```

## binToCode.py

### Purpose
* Small helper tool, to create C arrays from bin file, which then easily can be implemented in the stm32 code
* Reads the provided .bin file and converts it into a C style byte array
 
 ### Requirements
 * python3 installed on the system. [Python](https://www.python.org/)

### Usage
```
python3 binToCode.py <binfile.bin>
```
```
koebi@rpi4b:~/TeachZ80/Software/Z80/test$ python3 ../../tools/binToCode.py serial-polled.bin

BinToCode Script Version 1.0

#define Z80_TEST_PROGRAM_LENGTH     488

const uint8_t z80TestProgram[] {
     0x3E, 0x05, 0xD3, 0x10, 0x3E, 0x00, 0xD3, 0x20, 0x21, 0x00, 0x00, 0x11, 0x00, 0x00, 0x01, 0xE8, 
     0x01, 0xED, 0xB0, 0xDB, 0x70, 0x31, 0x00, 0x00, 0xCD, 0x27, 0x01, 0xCD, 0x22, 0x01, 0x21, 0x5C, 
     0x00, 0xCD, 0xCE, 0x01, 0x21, 0x00, 0x00, 0x01, 0xE8, 0x01, 0x1E, 0x01, 0xCD, 0x5B, 0x01, 0x21, 
     0xB8, 0x00, 0xCD, 0xCE, 0x01, 0xCD, 0x45, 0x00, 0x21, 0xE5, 0x00, 0xCD, 0xCE, 0x01, 0xCD, 0x52, 
     0x00, 0x76, 0xC3, 0x41, 0x00, 0x0E, 0x20, 0xCD, 0x41, 0x01, 0x0C, 0x3E, 0x7F, 0xB9, 0xC2, 0x47, 
     0x00, 0xC9, 0xCD, 0x53, 0x01, 0x4F, 0xCD, 0x41, 0x01, 0xC3, 0x52, 0x00, 0x0D, 0x0A, 0x0D, 0x0A, 
     0x48, 0x65, 0x6C, 0x6C, 0x6F, 0x20, 0x57, 0x6F, 0x72, 0x6C, 0x64, 0x20, 0x2D, 0x20, 0x54, 0x65, 
     0x61, 0x63, 0x68, 0x5A, 0x38, 0x30, 0x20, 0x73, 0x70, 0x65, 0x61, 0x6B, 0x69, 0x6E, 0x67, 0x20, 
     0x2D, 0x20, 0x57, 0x65, 0x6C, 0x6C, 0x20, 0x64, 0x6F, 0x6E, 0x65, 0x21, 0x0D, 0x0A, 0x0D, 0x0A, 
     0x54, 0x68, 0x69, 0x73, 0x20, 0x69, 0x73, 0x20, 0x74, 0x68, 0x65, 0x20, 0x63, 0x6F, 0x64, 0x65, 
     0x20, 0x49, 0x20, 0x63, 0x75, 0x72, 0x72, 0x65, 0x6E, 0x74, 0x6C, 0x79, 0x20, 0x65, 0x78, 0x65, 
     0x63, 0x75, 0x74, 0x65, 0x3A, 0x0D, 0x0A, 0x00, 0x0D, 0x0A, 0x41, 0x6E, 0x64, 0x20, 0x68, 0x65, 
     0x72, 0x65, 0x20, 0x74, 0x68, 0x65, 0x20, 0x70, 0x72, 0x69, 0x6E, 0x74, 0x61, 0x62, 0x6C, 0x65, 
     0x20, 0x41, 0x53, 0x43, 0x49, 0x49, 0x20, 0x63, 0x68, 0x61, 0x72, 0x61, 0x63, 0x74, 0x65, 0x72, 
     0x73, 0x3A, 0x0D, 0x0A, 0x00, 0x0D, 0x0A, 0x0D, 0x0A, 0x49, 0x20, 0x77, 0x69, 0x6C, 0x6C, 0x20, 
     0x6E, 0x6F, 0x77, 0x20, 0x65, 0x63, 0x68, 0x6F, 0x20, 0x77, 0x68, 0x61, 0x74, 0x65, 0x76, 0x65, 
     0x72, 0x20, 0x79, 0x6F, 0x75, 0x20, 0x74, 0x79, 0x70, 0x65, 0x3A, 0x0D, 0x0A, 0x00, 0xDB, 0x32, 
     0xE6, 0x04, 0xC9, 0xDB, 0x33, 0xE6, 0x04, 0xC9, 0xDB, 0x32, 0xE6, 0x01, 0xC9, 0xDB, 0x33, 0xE6, 
     0x01, 0xC9, 0x0E, 0x33, 0xC3, 0x29, 0x01, 0x0E, 0x32, 0x21, 0x31, 0x01, 0x06, 0x07, 0xED, 0xB3, 
     0xC9, 0x18, 0x04, 0x44, 0x03, 0xC1, 0x05, 0x68, 0xCD, 0x13, 0x01, 0x28, 0xFB, 0x79, 0xD3, 0x31, 
     0xC9, 0xCD, 0x0E, 0x01, 0x28, 0xFB, 0x79, 0xD3, 0x30, 0xC9, 0xCD, 0x1D, 0x01, 0x28, 0xFB, 0x3A, 
     0x31, 0x00, 0xC9, 0xCD, 0x18, 0x01, 0x28, 0xFB, 0xDB, 0x30, 0xC9, 0xF5, 0xD5, 0xE5, 0xC5, 0xC3, 
     0x7F, 0x01, 0x7B, 0xB7, 0x28, 0x0E, 0x7D, 0xE6, 0x0F, 0x28, 0x11, 0xFE, 0x08, 0x20, 0x05, 0x0E, 
     0x20, 0xCD, 0x41, 0x01, 0x0E, 0x20, 0xCD, 0x41, 0x01, 0xC3, 0x91, 0x01, 0xCD, 0xE1, 0x01, 0x7C, 
     0xCD, 0xA5, 0x01, 0x7D, 0xCD, 0xA5, 0x01, 0x0E, 0x3A, 0xCD, 0x41, 0x01, 0x0E, 0x20, 0xCD, 0x41, 
     0x01, 0x7E, 0xCD, 0xA5, 0x01, 0x23, 0xC1, 0x0B, 0xC5, 0x78, 0xB1, 0x20, 0xC5, 0xCD, 0xE1, 0x01, 
     0xC1, 0xE1, 0xD1, 0xF1, 0xC9, 0xF5, 0xCB, 0x3F, 0xCB, 0x3F, 0xCB, 0x3F, 0xCB, 0x3F, 0xCD, 0xBA, 
     0x01, 0xF1, 0xF5, 0xE6, 0x0F, 0xCD, 0xBA, 0x01, 0xF1, 0xC9, 0xC6, 0x30, 0xFE, 0x3A, 0xFA, 0xC3, 
     0x01, 0xC6, 0x07, 0x4F, 0xC3, 0x41, 0x01, 0xE3, 0xCD, 0xD4, 0x01, 0x23, 0xE3, 0xC9, 0xE5, 0xCD, 
     0xD4, 0x01, 0xE1, 0xC9, 0x7E, 0xB7, 0x28, 0x08, 0x4F, 0xCD, 0x41, 0x01, 0x23, 0xC3, 0xD4, 0x01, 
     0xC9, 0xCD, 0xC7, 0x01, 0x0D, 0x0A, 0x00, 0xC9
};

```
